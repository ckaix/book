<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <!--<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>-->
    <title>13-APIé£æ ¼ï¼ˆä¸‹ï¼‰ï¼šRPCAPIä»‹ç»</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <style>
        html {
            color: #333;
            -webkit-text-size-adjust: 100%;
            -ms-text-size-adjust: 100%;
            text-rendering: optimizelegibility;
            font-family: Helvetica Neue, PingFang SC, Verdana, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, sans-serif
        }

        html.borderbox *,
        html.borderbox :after,
        html.borderbox :before {
            box-sizing: border-box
        }

        article,
        aside,
        blockquote,
        body,
        button,
        code,
        dd,
        details,
        dl,
        dt,
        fieldset,
        figcaption,
        figure,
        footer,
        form,
        h1,
        h2,
        h3,
        h4,
        h5,
        h6,
        header,
        hr,
        input,
        legend,
        li,
        menu,
        nav,
        ol,
        p,
        pre,
        section,
        td,
        textarea,
        th,
        ul {
            margin: 0;
            padding: 0
        }

        article,
        aside,
        details,
        figcaption,
        figure,
        footer,
        header,
        menu,
        nav,
        section {
            display: block
        }

        audio,
        canvas,
        video {
            display: inline-block
        }

        body,
        button,
        input,
        select,
        textarea {
            font: 300 1em/1.8 PingFang SC, Lantinghei SC, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, Helvetica, sans-serif
        }

        button::-moz-focus-inner,
        input::-moz-focus-inner {
            padding: 0;
            border: 0
        }

        table {
            border-collapse: collapse;
            border-spacing: 0
        }

        fieldset,
        img {
            border: 0
        }

        blockquote {
            position: relative;
            color: #999;
            font-weight: 400;
            border-left: 1px solid #1abc9c;
            padding-left: 1em;
            margin: 1em 3em 1em 2em
        }

        @media only screen and (max-width: 640px) {
            blockquote {
                margin: 1em 0
            }
        }

        abbr,
        acronym {
            border-bottom: 1px dotted;
            font-variant: normal
        }

        abbr {
            cursor: help
        }

        del {
            text-decoration: line-through
        }

        address,
        caption,
        cite,
        code,
        dfn,
        em,
        th,
        var {
            font-style: normal;
            font-weight: 400
        }

        ol,
        ul {
            list-style: none
        }

        caption,
        th {
            text-align: left
        }

        q:after,
        q:before {
            content: ""
        }

        sub,
        sup {
            font-size: 75%;
            line-height: 0;
            position: relative
        }

        :root sub,
        :root sup {
            vertical-align: baseline
        }

        sup {
            top: -.5em
        }

        sub {
            bottom: -.25em
        }

        a {
            color: #1abc9c
        }

        a:hover {
            text-decoration: underline
        }

        .typo a {
            border-bottom: 1px solid #1abc9c
        }

        .typo a:hover {
            border-bottom-color: #555;
            color: #555
        }

        .typo a:hover,
        a,
        ins {
            text-decoration: none
        }

        .typo-u,
        u {
            text-decoration: underline
        }

        mark {
            background: #fffdd1;
            border-bottom: 1px solid #ffedce;
            padding: 2px;
            margin: 0 5px
        }

        code,
        pre,
        pre tt {
            font-family: Courier, Courier New, monospace
        }

        pre {
            background: hsla(0, 0%, 97%, .7);
            border: 1px solid #ddd;
            padding: 1em 1.5em;
            display: block;
            -webkit-overflow-scrolling: touch
        }

        hr {
            border: none;
            border-bottom: 1px solid #cfcfcf;
            margin-bottom: .8em;
            height: 10px
        }

        .typo-small,
        figcaption,
        small {
            font-size: .9em;
            color: #888
        }

        b,
        strong {
            font-weight: 700;
            color: #000
        }

        [draggable] {
            cursor: move
        }

        .clearfix:after,
        .clearfix:before {
            content: "";
            display: table
        }

        .clearfix:after {
            clear: both
        }

        .clearfix {
            zoom: 1
        }

        .textwrap,
        .textwrap td,
        .textwrap th {
            word-wrap: break-word;
            word-break: break-all
        }

        .textwrap-table {
            table-layout: fixed
        }

        .serif {
            font-family: Palatino, Optima, Georgia, serif
        }

        .typo-dl,
        .typo-form,
        .typo-hr,
        .typo-ol,
        .typo-p,
        .typo-pre,
        .typo-table,
        .typo-ul,
        .typo dl,
        .typo form,
        .typo hr,
        .typo ol,
        .typo p,
        .typo pre,
        .typo table,
        .typo ul,
        blockquote {
            margin-bottom: 1rem
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-family: PingFang SC, Helvetica Neue, Verdana, Microsoft Yahei, Hiragino Sans GB, Microsoft Sans Serif, WenQuanYi Micro Hei, sans-serif;
            color: #000;
            line-height: 1.35
        }

        .typo-h1,
        .typo-h2,
        .typo-h3,
        .typo-h4,
        .typo-h5,
        .typo-h6,
        .typo h1,
        .typo h2,
        .typo h3,
        .typo h4,
        .typo h5,
        .typo h6 {
            margin-top: 1.2em;
            margin-bottom: .6em;
            line-height: 1.35
        }

        .typo-h1,
        .typo h1 {
            font-size: 2em
        }

        .typo-h2,
        .typo h2 {
            font-size: 1.8em
        }

        .typo-h3,
        .typo h3 {
            font-size: 1.6em
        }

        .typo-h4,
        .typo h4 {
            font-size: 1.4em
        }

        .typo-h5,
        .typo-h6,
        .typo h5,
        .typo h6 {
            font-size: 1.2em
        }

        .typo-ul,
        .typo ul {
            margin-left: 1.3em;
            list-style: disc
        }

        .typo-ol,
        .typo ol {
            list-style: decimal;
            margin-left: 1.9em
        }

        .typo-ol ol,
        .typo-ol ul,
        .typo-ul ol,
        .typo-ul ul,
        .typo li ol,
        .typo li ul {
            margin-bottom: .8em;
            margin-left: 2em
        }

        .typo-ol ul,
        .typo-ul ul,
        .typo li ul {
            list-style: circle
        }

        .typo-table td,
        .typo-table th,
        .typo table caption,
        .typo table td,
        .typo table th {
            border: 1px solid #ddd;
            padding: .5em 1em;
            color: #666
        }

        .typo-table th,
        .typo table th {
            background: #fbfbfb
        }

        .typo-table thead th,
        .typo table thead th {
            background: hsla(0, 0%, 95%, .7)
        }

        .typo table caption {
            border-bottom: none
        }

        .typo-input,
        .typo-textarea {
            -webkit-appearance: none;
            border-radius: 0
        }

        .typo-em,
        .typo em,
        caption,
        legend {
            color: #000;
            font-weight: inherit
        }

        .typo-em {
            position: relative
        }

        .typo-em:after {
            position: absolute;
            top: .65em;
            left: 0;
            width: 100%;
            overflow: hidden;
            white-space: nowrap;
            content: "\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB"
        }

        .typo img {
            max-width: 100%
        }

        .common-content {
            font-weight: 400;
            color: #353535;
            line-height: 1.75rem;
            white-space: normal;
            word-break: normal;
            font-size: 1rem
        }

        .common-content img {
            display: block;
            max-width: 100%;
            background-color: #eee
        }

        .common-content audio,
        .common-content video {
            width: 100%;
            background-color: #eee
        }

        .common-content center,
        .common-content font {
            margin-top: 1rem;
            display: inline-block
        }

        .common-content center {
            width: 100%
        }

        .common-content pre {
            margin-top: 1rem;
            padding-left: 0;
            padding-right: 0;
            position: relative;
            overflow: hidden
        }

        .common-content pre code {
            font-size: .8rem;
            font-family: Consolas, Liberation Mono, Menlo, monospace, Courier;
            display: block;
            width: 100%;
            box-sizing: border-box;
            padding-left: 1rem;
            padding-right: 1rem;
            overflow-x: auto
        }

        .common-content hr {
            border: none;
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
            border-top: 1px solid #f5f5f5;
            height: 1px;
            background: none
        }

        .common-content b,
        .common-content h1,
        .common-content h2,
        .common-content h3,
        .common-content h4,
        .common-content h5,
        .common-content strong {
            font-weight: 700
        }

        .common-content h1,
        .common-content h2 {
            font-size: 1.125rem;
            margin-bottom: .45rem
        }

        .common-content h3,
        .common-content h4,
        .common-content h5 {
            font-size: 1rem;
            margin-bottom: .45rem
        }

        .common-content p {
            font-weight: 400;
            color: #353535;
            margin-top: .15rem
        }

        .common-content .orange {
            color: #ff5a05
        }

        .common-content .reference {
            font-size: 1rem;
            color: #888
        }

        .custom-rich-content h1 {
            margin-top: 0;
            font-weight: 400;
            font-size: 15.25px;
            border-bottom: 1px solid #eee;
            line-height: 2.8
        }

        .custom-rich-content li,
        .custom-rich-content p {
            font-size: 14px;
            color: #888;
            line-height: 1.6
        }

        table.hljs-ln {
            margin-bottom: 0;
            border-spacing: 0;
            border-collapse: collapse
        }

        table.hljs-ln,
        table.hljs-ln tbody,
        table.hljs-ln td,
        table.hljs-ln tr {
            box-sizing: border-box
        }

        table.hljs-ln td {
            padding: 0;
            border: 0
        }

        table.hljs-ln td.hljs-ln-numbers {
            min-width: 15px;
            color: rgba(27, 31, 35, .3);
            text-align: right;
            white-space: nowrap;
            cursor: pointer;
            user-select: none
        }

        table.hljs-ln td.hljs-ln-code,
        table.hljs-ln td.hljs-ln-numbers {
            font-family: SFMono-Regular, Consolas, Liberation Mono, Menlo, Courier, monospace;
            font-size: 12px;
            line-height: 20px;
            vertical-align: top
        }

        table.hljs-ln td.hljs-ln-code {
            position: relative;
            padding-right: 10px;
            padding-left: 10px;
            overflow: visible;
            color: #24292e;
            word-wrap: normal;
            white-space: pre
        }

        video::-webkit-media-controls {
            overflow: hidden !important
        }

        video::-webkit-media-controls-enclosure {
            width: calc(100% + 32px);
            margin-left: auto
        }

        ._29HP61GA_0 {
            max-width:800px;
            margin:0 auto;
            margin-bottom: 20px;
            font-weight: 400;
            color: #353535;
            line-height: 1.76;
            white-space: normal;
            word-break: normal;
            font-size: 17px;
            -webkit-transition: background-color .3s ease;
            transition: background-color .3s ease
        }

        ._29HP61GA_0 .MathJax_Display {
            overflow: auto
        }

        ._29HP61GA_0 .poster {
            position: fixed;
            left: -10000px;
            top: -10000px;
            overflow: hidden;
            padding: 1rem;
            background: #ececec
        }

        ._29HP61GA_0 .richcontent-pre-copy {
            font-size: 13px;
            color: #888;
            position: absolute;
            right: 1em;
            top: .5em;
            cursor: pointer;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none
        }

        ._29HP61GA_0 .richcontent-pre-copy .iconfont {
            font-size: 12px;
            margin-right: .2em
        }

        ._29HP61GA_0 a {
            color: #fa8919;
            border-bottom: 1px solid #fa8919
        }

        ._29HP61GA_0 img {
            display: block;
            max-width: 100%;
            position: relative;
            left: 50%;
            -webkit-transform: translateX(-50%);
            transform: translateX(-50%);
            background-color: #eee;
            vertical-align: top;
            border-radius: 0
        }

        ._29HP61GA_0 audio,
        ._29HP61GA_0 video {
            width: 100%;
            background-color: #eee
        }

        ._29HP61GA_0 pre {
            margin-top: 16px;
            padding: 34px 0 0;
            margin-bottom: 30px;
            position: relative;
            border-radius: 6px;
            background: rgba(246, 247, 251, .749);
            border: 0
        }

        ._29HP61GA_0 pre code {
            font-size: 12px;
            font-family: Consolas, Liberation Mono, Menlo, monospace, Courier;
            display: block;
            -webkit-box-sizing: border-box;
            box-sizing: border-box;
            margin-left: 16px;
            margin-right: 16px;
            overflow-x: scroll
        }

        ._29HP61GA_0 pre code:after {
            content: "";
            height: 30px;
            width: 100%;
            display: block
        }

        ._29HP61GA_0 hr {
            border: none;
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
            border-top: 1px solid #f5f5f5;
            height: 1px;
            background: none
        }

        ._29HP61GA_0 h1,
        ._29HP61GA_0 h2,
        ._29HP61GA_0 h3,
        ._29HP61GA_0 h4,
        ._29HP61GA_0 h5 {
            margin-bottom: 20px;
            margin-top: 0;
            font-weight: 700
        }

        ._29HP61GA_0 b,
        ._29HP61GA_0 strong {
            font-weight: 700
        }

        ._29HP61GA_0 h1 {
            font-size: 21px
        }

        ._29HP61GA_0 h2 {
            font-size: 20px
        }

        ._29HP61GA_0 h3 {
            font-size: 19px
        }

        ._29HP61GA_0 h4 {
            font-size: 18px
        }

        ._29HP61GA_0 h5 {
            font-size: 17px
        }

        ._29HP61GA_0 center,
        ._29HP61GA_0 p {
            font-weight: 400;
            color: #353535;
            margin-top: 0;
            margin-bottom: 30px;
            word-break: break-word
        }

        ._29HP61GA_0 center {
            text-align: center
        }

        ._29HP61GA_0 blockquote {
            margin-top: 0;
            margin-bottom: 34px;
            border-left: 3px solid #e8e8e8;
            padding-left: 17px;
            color: #353535
        }

        ._29HP61GA_0 blockquote p {
            margin-top: 0;
            margin-bottom: 0
        }

        ._29HP61GA_0 ol,
        ._29HP61GA_0 ul {
            margin-bottom: 30px
        }

        ._29HP61GA_0 ol p,
        ._29HP61GA_0 ul p {
            margin-top: 0;
            margin-bottom: 0
        }

        ._29HP61GA_0 ol {
            list-style: decimal;
            margin-left: 20px
        }

        ._29HP61GA_0 ul li {
            padding-left: 17px;
            position: relative;
            margin-bottom: 10px
        }

        ._29HP61GA_0 ul li:after {
            content: "";
            height: 6px;
            width: 6px;
            border-radius: 50%;
            background: #353535;
            position: absolute;
            top: 10px;
            left: 0
        }

        ._29HP61GA_0 .orange {
            color: #fa8919
        }

        ._29HP61GA_0 .reference {
            color: #888
        }

        ._29HP61GA_0 .m-right {
            text-align: right
        }

        ._29HP61GA_0 .m-center {
            text-align: center;
            display: block
        }

        ._29HP61GA_0 .m-gray {
            color: #888
        }

        ._29HP61GA_0 .m-small {
            font-size: 15px
        }

        ._29HP61GA_0 table.hljs-ln {
            margin-bottom: 0;
            border-spacing: 0;
            border-collapse: collapse
        }

        ._29HP61GA_0 table.hljs-ln,
        ._29HP61GA_0 table.hljs-ln tbody,
        ._29HP61GA_0 table.hljs-ln td,
        ._29HP61GA_0 table.hljs-ln tr {
            -webkit-box-sizing: border-box;
            box-sizing: border-box
        }

        ._29HP61GA_0 table.hljs-ln td {
            padding: 0;
            border: 0
        }

        ._29HP61GA_0 table.hljs-ln td.hljs-ln-numbers {
            min-width: 15px;
            font-size: 12px;
            color: rgba(27, 31, 35, .3);
            text-align: right;
            white-space: nowrap;
            cursor: pointer;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none
        }

        ._29HP61GA_0 table.hljs-ln td.hljs-ln-code,
        ._29HP61GA_0 table.hljs-ln td.hljs-ln-numbers {
            font-family: SFMono-Regular, Consolas, Liberation Mono, Menlo, Courier, monospace;
            line-height: 20px;
            vertical-align: top
        }

        ._29HP61GA_0 table.hljs-ln td.hljs-ln-code {
            position: relative;
            padding-right: 10px;
            padding-left: 10px;
            overflow: visible;
            font-size: 13px;
            color: #666;
            word-wrap: normal;
            white-space: pre
        }

    </style>
</head>
<body>
<div class="_29HP61GA_0">
<h1>13-APIé£æ ¼ï¼ˆä¸‹ï¼‰ï¼šRPCAPIä»‹ç»</h1>
<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å­”ä»¤é£ã€‚è¿™ä¸€è®²ï¼Œæˆ‘ä»¬ç»§ç»­æ¥çœ‹ä¸‹å¦‚ä½•è®¾è®¡åº”ç”¨çš„APIé£æ ¼ã€‚</p><p>ä¸Šä¸€è®²ï¼Œæˆ‘ä»‹ç»äº†REST APIé£æ ¼ï¼Œè¿™ä¸€è®²æˆ‘æ¥ä»‹ç»ä¸‹å¦å¤–ä¸€ç§å¸¸ç”¨çš„APIé£æ ¼ï¼ŒRPCã€‚åœ¨Goé¡¹ç›®å¼€å‘ä¸­ï¼Œå¦‚æœä¸šåŠ¡å¯¹æ€§èƒ½è¦æ±‚æ¯”è¾ƒé«˜ï¼Œå¹¶ä¸”éœ€è¦æä¾›ç»™å¤šç§ç¼–ç¨‹è¯­è¨€è°ƒç”¨ï¼Œè¿™æ—¶å€™å°±å¯ä»¥è€ƒè™‘ä½¿ç”¨RPC APIæ¥å£ã€‚RPCåœ¨Goé¡¹ç›®å¼€å‘ä¸­ç”¨å¾—ä¹Ÿéå¸¸å¤šï¼Œéœ€è¦æˆ‘ä»¬è®¤çœŸæŒæ¡ã€‚</p><h2>RPCä»‹ç»</h2><p>æ ¹æ®ç»´åŸºç™¾ç§‘çš„å®šä¹‰ï¼ŒRPCï¼ˆRemote Procedure Callï¼‰ï¼Œå³è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼Œæ˜¯ä¸€ä¸ªè®¡ç®—æœºé€šä¿¡åè®®ã€‚è¯¥åè®®å…è®¸è¿è¡Œäºä¸€å°è®¡ç®—æœºçš„ç¨‹åºè°ƒç”¨å¦ä¸€å°è®¡ç®—æœºçš„å­ç¨‹åºï¼Œè€Œç¨‹åºå‘˜ä¸ç”¨é¢å¤–åœ°ä¸ºè¿™ä¸ªäº¤äº’ä½œç”¨ç¼–ç¨‹ã€‚</p><p>é€šä¿—æ¥è®²ï¼Œå°±æ˜¯æœåŠ¡ç«¯å®ç°äº†ä¸€ä¸ªå‡½æ•°ï¼Œå®¢æˆ·ç«¯ä½¿ç”¨RPCæ¡†æ¶æä¾›çš„æ¥å£ï¼Œåƒè°ƒç”¨æœ¬åœ°å‡½æ•°ä¸€æ ·è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¹¶è·å–è¿”å›å€¼ã€‚RPCå±è”½äº†åº•å±‚çš„ç½‘ç»œé€šä¿¡ç»†èŠ‚ï¼Œä½¿å¾—å¼€å‘äººå‘˜æ— éœ€å…³æ³¨ç½‘ç»œç¼–ç¨‹çš„ç»†èŠ‚ï¼Œå¯ä»¥å°†æ›´å¤šçš„æ—¶é—´å’Œç²¾åŠ›æ”¾åœ¨ä¸šåŠ¡é€»è¾‘æœ¬èº«çš„å®ç°ä¸Šï¼Œä»è€Œæé«˜å¼€å‘æ•ˆç‡ã€‚</p><p>RPCçš„è°ƒç”¨è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://static001.geekbang.org/resource/image/98/1d/984yy094616b9b24193b22a1f2f2271d.png?wh=2521x1671" alt=""></p><p>RPCè°ƒç”¨å…·ä½“æµç¨‹å¦‚ä¸‹ï¼š</p><ol>
<li>Clienté€šè¿‡æœ¬åœ°è°ƒç”¨ï¼Œè°ƒç”¨Client Stubã€‚</li>
<li>Client Stubå°†å‚æ•°æ‰“åŒ…ï¼ˆä¹Ÿå«Marshallingï¼‰æˆä¸€ä¸ªæ¶ˆæ¯ï¼Œç„¶åå‘é€è¿™ä¸ªæ¶ˆæ¯ã€‚</li>
<li>Clientæ‰€åœ¨çš„OSå°†æ¶ˆæ¯å‘é€ç»™Serverã€‚</li>
<li>Serverç«¯æ¥æ”¶åˆ°æ¶ˆæ¯åï¼Œå°†æ¶ˆæ¯ä¼ é€’ç»™Server Stubã€‚</li>
<li>Server Stubå°†æ¶ˆæ¯è§£åŒ…ï¼ˆä¹Ÿå« Unmarshallingï¼‰å¾—åˆ°å‚æ•°ã€‚</li>
<li>Server Stubè°ƒç”¨æœåŠ¡ç«¯çš„å­ç¨‹åºï¼ˆå‡½æ•°ï¼‰ï¼Œå¤„ç†å®Œåï¼Œå°†æœ€ç»ˆç»“æœæŒ‰ç…§ç›¸åçš„æ­¥éª¤è¿”å›ç»™ Clientã€‚</li>
</ol><!-- [[[read_end]]] --><p>è¿™é‡Œéœ€è¦æ³¨æ„ï¼ŒStubè´Ÿè´£è°ƒç”¨å‚æ•°å’Œè¿”å›å€¼çš„æµåŒ–ï¼ˆserializationï¼‰ã€å‚æ•°çš„æ‰“åŒ…å’Œè§£åŒ…ï¼Œä»¥åŠç½‘ç»œå±‚çš„é€šä¿¡ã€‚Clientç«¯ä¸€èˆ¬å«Stubï¼ŒServerç«¯ä¸€èˆ¬å«Skeletonã€‚</p><p>ç›®å‰ï¼Œä¸šç•Œæœ‰å¾ˆå¤šä¼˜ç§€çš„RPCåè®®ï¼Œä¾‹å¦‚è…¾è®¯çš„Tarsã€é˜¿é‡Œçš„Dubboã€å¾®åšçš„Motanã€Facebookçš„Thriftã€RPCXï¼Œç­‰ç­‰ã€‚ä½†ä½¿ç”¨æœ€å¤šçš„è¿˜æ˜¯<a href="https://github.com/grpc/grpc-go">gRPC</a>ï¼Œè¿™ä¹Ÿæ˜¯æœ¬ä¸“æ æ‰€é‡‡ç”¨çš„RPCæ¡†æ¶ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥æˆ‘ä¼šé‡ç‚¹ä»‹ç»gRPCæ¡†æ¶ã€‚</p><h2>gRPCä»‹ç»</h2><p>gRPCæ˜¯ç”±Googleå¼€å‘çš„é«˜æ€§èƒ½ã€å¼€æºã€è·¨å¤šç§ç¼–ç¨‹è¯­è¨€çš„é€šç”¨RPCæ¡†æ¶ï¼ŒåŸºäºHTTP 2.0åè®®å¼€å‘ï¼Œé»˜è®¤é‡‡ç”¨Protocol Buffersæ•°æ®åºåˆ—åŒ–åè®®ã€‚gRPCå…·æœ‰å¦‚ä¸‹ç‰¹æ€§ï¼š</p><ul>
<li>æ”¯æŒå¤šç§è¯­è¨€ï¼Œä¾‹å¦‚ Goã€Javaã€Cã€C++ã€C#ã€Node.jsã€PHPã€Pythonã€Rubyç­‰ã€‚</li>
<li>åŸºäºIDLï¼ˆInterface Definition Languageï¼‰æ–‡ä»¶å®šä¹‰æœåŠ¡ï¼Œé€šè¿‡proto3å·¥å…·ç”ŸæˆæŒ‡å®šè¯­è¨€çš„æ•°æ®ç»“æ„ã€æœåŠ¡ç«¯æ¥å£ä»¥åŠå®¢æˆ·ç«¯Stubã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä¹Ÿå¯ä»¥å°†æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯è§£è€¦ï¼Œä½¿å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å¯ä»¥å¹¶è¡Œå¼€å‘ã€‚</li>
<li>é€šä¿¡åè®®åŸºäºæ ‡å‡†çš„HTTP/2è®¾è®¡ï¼Œæ”¯æŒåŒå‘æµã€æ¶ˆæ¯å¤´å‹ç¼©ã€å•TCPçš„å¤šè·¯å¤ç”¨ã€æœåŠ¡ç«¯æ¨é€ç­‰ç‰¹æ€§ã€‚</li>
<li>æ”¯æŒProtobufå’ŒJSONåºåˆ—åŒ–æ•°æ®æ ¼å¼ã€‚Protobufæ˜¯ä¸€ç§è¯­è¨€æ— å…³çš„é«˜æ€§èƒ½åºåˆ—åŒ–æ¡†æ¶ï¼Œå¯ä»¥å‡å°‘ç½‘ç»œä¼ è¾“æµé‡ï¼Œæé«˜é€šä¿¡æ•ˆç‡ã€‚</li>
</ul><p>è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼ŒgRPCçš„å…¨ç§°ä¸æ˜¯golang Remote Procedure Callï¼Œè€Œæ˜¯google Remote Procedure Callã€‚</p><p>gRPCçš„è°ƒç”¨å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://static001.geekbang.org/resource/image/01/09/01ac424c7c1d64f678e1218827bc0109.png?wh=2079x1025" alt=""></p><p>åœ¨gRPCä¸­ï¼Œå®¢æˆ·ç«¯å¯ä»¥ç›´æ¥è°ƒç”¨éƒ¨ç½²åœ¨ä¸åŒæœºå™¨ä¸Šçš„gRPCæœåŠ¡æ‰€æä¾›çš„æ–¹æ³•ï¼Œè°ƒç”¨è¿œç«¯çš„gRPCæ–¹æ³•å°±åƒè°ƒç”¨æœ¬åœ°çš„æ–¹æ³•ä¸€æ ·ï¼Œéå¸¸ç®€å•æ–¹ä¾¿ï¼Œé€šè¿‡gRPCè°ƒç”¨<strong>ï¼Œæˆ‘ä»¬å¯ä»¥éå¸¸å®¹æ˜“åœ°æ„å»ºå‡ºä¸€ä¸ªåˆ†å¸ƒå¼åº”ç”¨ã€‚</strong></p><p>åƒå¾ˆå¤šå…¶ä»–çš„RPCæœåŠ¡ä¸€æ ·ï¼ŒgRPCä¹Ÿæ˜¯é€šè¿‡IDLè¯­è¨€ï¼Œé¢„å…ˆå®šä¹‰å¥½æ¥å£ï¼ˆæ¥å£çš„åå­—ã€ä¼ å…¥å‚æ•°å’Œè¿”å›å‚æ•°ç­‰ï¼‰ã€‚åœ¨æœåŠ¡ç«¯ï¼ŒgRPCæœåŠ¡å®ç°æˆ‘ä»¬æ‰€å®šä¹‰çš„æ¥å£ã€‚åœ¨å®¢æˆ·ç«¯ï¼ŒgRPCå­˜æ ¹æä¾›äº†è·ŸæœåŠ¡ç«¯ç›¸åŒçš„æ–¹æ³•ã€‚</p><p>gRPCæ”¯æŒå¤šç§è¯­è¨€ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥ç”¨Goè¯­è¨€å®ç°gRPCæœåŠ¡ï¼Œå¹¶é€šè¿‡Javaè¯­è¨€å®¢æˆ·ç«¯è°ƒç”¨gRPCæœåŠ¡æ‰€æä¾›çš„æ–¹æ³•ã€‚é€šè¿‡å¤šè¯­è¨€æ”¯æŒï¼Œæˆ‘ä»¬ç¼–å†™çš„gRPCæœåŠ¡èƒ½æ»¡è¶³å®¢æˆ·ç«¯å¤šè¯­è¨€çš„éœ€æ±‚ã€‚</p><p>gRPC APIæ¥å£é€šå¸¸ä½¿ç”¨çš„æ•°æ®ä¼ è¾“æ ¼å¼æ˜¯Protocol Buffersã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±ä¸€èµ·äº†è§£ä¸‹Protocol Buffersã€‚</p><h2>Protocol Buffersä»‹ç»</h2><p>Protocol Buffersï¼ˆProtocolBuffer/ protobufï¼‰æ˜¯Googleå¼€å‘çš„ä¸€å¥—å¯¹æ•°æ®ç»“æ„è¿›è¡Œåºåˆ—åŒ–çš„æ–¹æ³•ï¼Œå¯ç”¨ä½œï¼ˆæ•°æ®ï¼‰é€šä¿¡åè®®ã€æ•°æ®å­˜å‚¨æ ¼å¼ç­‰ï¼Œä¹Ÿæ˜¯ä¸€ç§æ›´åŠ çµæ´»ã€é«˜æ•ˆçš„æ•°æ®æ ¼å¼ï¼Œä¸XMLã€JSONç±»ä¼¼ã€‚å®ƒçš„ä¼ è¾“æ€§èƒ½éå¸¸å¥½ï¼Œæ‰€ä»¥å¸¸è¢«ç”¨åœ¨ä¸€äº›å¯¹æ•°æ®ä¼ è¾“æ€§èƒ½è¦æ±‚æ¯”è¾ƒé«˜çš„ç³»ç»Ÿä¸­ï¼Œä½œä¸ºæ•°æ®ä¼ è¾“æ ¼å¼ã€‚Protocol Buffersçš„ä¸»è¦ç‰¹æ€§æœ‰ä¸‹é¢è¿™å‡ ä¸ªã€‚</p><ul>
<li>æ›´å¿«çš„æ•°æ®ä¼ è¾“é€Ÿåº¦ï¼šprotobufåœ¨ä¼ è¾“æ—¶ï¼Œä¼šå°†æ•°æ®åºåˆ—åŒ–ä¸ºäºŒè¿›åˆ¶æ•°æ®ï¼Œå’ŒXMLã€JSONçš„æ–‡æœ¬ä¼ è¾“æ ¼å¼ç›¸æ¯”ï¼Œè¿™å¯ä»¥èŠ‚çœå¤§é‡çš„IOæ“ä½œï¼Œä»è€Œæé«˜æ•°æ®ä¼ è¾“é€Ÿåº¦ã€‚</li>
<li>è·¨å¹³å°å¤šè¯­è¨€ï¼šprotobufè‡ªå¸¦çš„ç¼–è¯‘å·¥å…· protoc å¯ä»¥åŸºäºprotobufå®šä¹‰æ–‡ä»¶ï¼Œç¼–è¯‘å‡ºä¸åŒè¯­è¨€çš„å®¢æˆ·ç«¯æˆ–è€…æœåŠ¡ç«¯ï¼Œä¾›ç¨‹åºç›´æ¥è°ƒç”¨ï¼Œå› æ­¤å¯ä»¥æ»¡è¶³å¤šè¯­è¨€éœ€æ±‚çš„åœºæ™¯ã€‚</li>
<li>å…·æœ‰éå¸¸å¥½çš„æ‰©å±•æ€§å’Œå…¼å®¹æ€§ï¼Œå¯ä»¥æ›´æ–°å·²æœ‰çš„æ•°æ®ç»“æ„ï¼Œè€Œä¸ç ´åå’Œå½±å“åŸæœ‰çš„ç¨‹åºã€‚</li>
<li>åŸºäºIDLæ–‡ä»¶å®šä¹‰æœåŠ¡ï¼Œé€šè¿‡proto3å·¥å…·ç”ŸæˆæŒ‡å®šè¯­è¨€çš„æ•°æ®ç»“æ„ã€æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯æ¥å£ã€‚</li>
</ul><p>åœ¨gRPCçš„æ¡†æ¶ä¸­ï¼ŒProtocol Buffersä¸»è¦æœ‰ä¸‰ä¸ªä½œç”¨ã€‚</p><p><strong>ç¬¬ä¸€ï¼Œå¯ä»¥ç”¨æ¥å®šä¹‰æ•°æ®ç»“æ„ã€‚</strong>ä¸¾ä¸ªä¾‹å­ï¼Œä¸‹é¢çš„ä»£ç å®šä¹‰äº†ä¸€ä¸ªSecretInfoæ•°æ®ç»“æ„ï¼š</p><pre><code>// SecretInfo contains secret details.
message SecretInfo {
    string name = 1;
    string secret_id  = 2;
    string username   = 3;
    string secret_key = 4;
    int64 expires = 5;
    string description = 6;
    string created_at = 7;
    string updated_at = 8;
}
</code></pre><p><strong>ç¬¬äºŒï¼Œå¯ä»¥ç”¨æ¥å®šä¹‰æœåŠ¡æ¥å£ã€‚</strong>ä¸‹é¢çš„ä»£ç å®šä¹‰äº†ä¸€ä¸ªCacheæœåŠ¡ï¼ŒæœåŠ¡åŒ…å«äº†ListSecretså’ŒListPolicies ä¸¤ä¸ªAPIæ¥å£ã€‚</p><pre><code>// Cache implements a cache rpc service.
service Cache{
  rpc ListSecrets(ListSecretsRequest) returns (ListSecretsResponse) {}
  rpc ListPolicies(ListPoliciesRequest) returns (ListPoliciesResponse) {}
}
</code></pre><p><strong>ç¬¬ä¸‰ï¼Œå¯ä»¥é€šè¿‡protobufåºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œæå‡ä¼ è¾“æ•ˆç‡ã€‚</strong></p><h2>gRPCç¤ºä¾‹</h2><p>æˆ‘ä»¬å·²ç»å¯¹gRPCè¿™ä¸€é€šç”¨RPCæ¡†æ¶æœ‰äº†ä¸€å®šçš„äº†è§£ï¼Œä½†æ˜¯ä½ å¯èƒ½è¿˜ä¸æ¸…æ¥šæ€ä¹ˆä½¿ç”¨gRPCç¼–å†™APIæ¥å£ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘å°±é€šè¿‡gRPCå®˜æ–¹çš„ä¸€ä¸ªç¤ºä¾‹æ¥å¿«é€Ÿç»™å¤§å®¶å±•ç¤ºä¸‹ã€‚è¿è¡Œæœ¬ç¤ºä¾‹éœ€è¦åœ¨LinuxæœåŠ¡å™¨ä¸Šå®‰è£…Goç¼–è¯‘å™¨ã€Protocol bufferç¼–è¯‘å™¨ï¼ˆprotocï¼Œv3ï¼‰å’Œ protoc çš„Goè¯­è¨€æ’ä»¶ï¼Œåœ¨ <a href="https://time.geekbang.org/column/article/378076"><strong>02è®²</strong></a> ä¸­æˆ‘ä»¬å·²ç»å®‰è£…è¿‡ï¼Œè¿™é‡Œä¸å†è®²å…·ä½“çš„å®‰è£…æ–¹æ³•ã€‚</p><p>è¿™ä¸ªç¤ºä¾‹åˆ†ä¸ºä¸‹é¢å‡ ä¸ªæ­¥éª¤ï¼š</p><ol>
<li>å®šä¹‰gRPCæœåŠ¡ã€‚</li>
<li>ç”Ÿæˆå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä»£ç ã€‚</li>
<li>å®ç°gRPCæœåŠ¡ã€‚</li>
<li>å®ç°gRPCå®¢æˆ·ç«¯ã€‚</li>
</ol><p>ç¤ºä¾‹ä»£ç å­˜æ”¾åœ¨<a href="https://github.com/marmotedu/gopractise-demo/tree/main/apistyle/greeter">gopractise-demo/apistyle/greeter</a>ç›®å½•ä¸‹ã€‚ä»£ç ç»“æ„å¦‚ä¸‹ï¼š</p><pre><code>$ tree
â”œâ”€â”€ client
â”‚   â””â”€â”€ main.go
â”œâ”€â”€ helloworld
â”‚   â”œâ”€â”€ helloworld.pb.go
â”‚   â””â”€â”€ helloworld.proto
â””â”€â”€ server
    â””â”€â”€ main.go
</code></pre><p>clientç›®å½•å­˜æ”¾Clientç«¯çš„ä»£ç ï¼Œhelloworldç›®å½•ç”¨æ¥å­˜æ”¾æœåŠ¡çš„IDLå®šä¹‰ï¼Œserverç›®å½•ç”¨æ¥å­˜æ”¾Serverç«¯çš„ä»£ç ã€‚</p><p>ä¸‹é¢æˆ‘å…·ä½“ä»‹ç»ä¸‹è¿™ä¸ªç¤ºä¾‹çš„å››ä¸ªæ­¥éª¤ã€‚</p><ol>
<li>å®šä¹‰gRPCæœåŠ¡ã€‚</li>
</ol><p>é¦–å…ˆï¼Œéœ€è¦å®šä¹‰æˆ‘ä»¬çš„æœåŠ¡ã€‚è¿›å…¥helloworldç›®å½•ï¼Œæ–°å»ºæ–‡ä»¶helloworld.protoï¼š</p><pre><code>$ cd helloworld
$ vi helloworld.proto
</code></pre><p>å†…å®¹å¦‚ä¸‹ï¼š</p><pre><code>syntax = &quot;proto3&quot;;

option go_package = &quot;github.com/marmotedu/gopractise-demo/apistyle/greeter/helloworld&quot;;

package helloworld;

// The greeting service definition.
service Greeter {
  // Sends a greeting
  rpc SayHello (HelloRequest) returns (HelloReply) {}
}

// The request message containing the user's name.
message HelloRequest {
  string name = 1;
}

// The response message containing the greetings
message HelloReply {
  string message = 1;
}
</code></pre><p>åœ¨helloworld.protoå®šä¹‰æ–‡ä»¶ä¸­ï¼Œoptionå…³é”®å­—ç”¨æ¥å¯¹.protoæ–‡ä»¶è¿›è¡Œä¸€äº›è®¾ç½®ï¼Œå…¶ä¸­go_packageæ˜¯å¿…éœ€çš„è®¾ç½®ï¼Œè€Œä¸”go_packageçš„å€¼å¿…é¡»æ˜¯åŒ…å¯¼å…¥çš„è·¯å¾„ã€‚packageå…³é”®å­—æŒ‡å®šç”Ÿæˆçš„.pb.goæ–‡ä»¶æ‰€åœ¨çš„åŒ…åã€‚æˆ‘ä»¬é€šè¿‡serviceå…³é”®å­—å®šä¹‰æœåŠ¡ï¼Œç„¶åå†æŒ‡å®šè¯¥æœåŠ¡æ‹¥æœ‰çš„RPCæ–¹æ³•ï¼Œå¹¶å®šä¹‰æ–¹æ³•çš„è¯·æ±‚å’Œè¿”å›çš„ç»“æ„ä½“ç±»å‹ï¼š</p><pre><code>service Greeter {
  // Sends a greeting
  rpc SayHello (HelloRequest) returns (HelloReply) {}
}
</code></pre><p>gRPCæ”¯æŒå®šä¹‰4ç§ç±»å‹çš„æœåŠ¡æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯ç®€å•æ¨¡å¼ã€æœåŠ¡ç«¯æ•°æ®æµæ¨¡å¼ã€å®¢æˆ·ç«¯æ•°æ®æµæ¨¡å¼å’ŒåŒå‘æ•°æ®æµæ¨¡å¼ã€‚</p><ul>
<li>
<p>ç®€å•æ¨¡å¼ï¼ˆSimple RPCï¼‰ï¼šæ˜¯æœ€ç®€å•çš„gRPCæ¨¡å¼ã€‚å®¢æˆ·ç«¯å‘èµ·ä¸€æ¬¡è¯·æ±‚ï¼ŒæœåŠ¡ç«¯å“åº”ä¸€ä¸ªæ•°æ®ã€‚å®šä¹‰æ ¼å¼ä¸ºrpc SayHello (HelloRequest) returns (HelloReply) {}ã€‚</p>
</li>
<li>
<p>æœåŠ¡ç«¯æ•°æ®æµæ¨¡å¼ï¼ˆServer-side streaming RPCï¼‰ï¼šå®¢æˆ·ç«¯å‘é€ä¸€ä¸ªè¯·æ±‚ï¼ŒæœåŠ¡å™¨è¿”å›æ•°æ®æµå“åº”ï¼Œå®¢æˆ·ç«¯ä»æµä¸­è¯»å–æ•°æ®ç›´åˆ°ä¸ºç©ºã€‚å®šä¹‰æ ¼å¼ä¸ºrpc SayHello (HelloRequest) returns (stream HelloReply) {}ã€‚</p>
</li>
<li>
<p>å®¢æˆ·ç«¯æ•°æ®æµæ¨¡å¼ï¼ˆClient-side streaming RPCï¼‰ï¼šå®¢æˆ·ç«¯å°†æ¶ˆæ¯ä»¥æµçš„æ–¹å¼å‘é€ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å…¨éƒ¨å¤„ç†å®Œæˆä¹‹åè¿”å›ä¸€æ¬¡å“åº”ã€‚å®šä¹‰æ ¼å¼ä¸ºrpc SayHello (stream HelloRequest) returns (HelloReply) {}ã€‚</p>
</li>
<li>
<p>åŒå‘æ•°æ®æµæ¨¡å¼ï¼ˆBidirectional streaming RPCï¼‰ï¼šå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½å¯ä»¥å‘å¯¹æ–¹å‘é€æ•°æ®æµï¼Œè¿™ä¸ªæ—¶å€™åŒæ–¹çš„æ•°æ®å¯ä»¥åŒæ—¶äº’ç›¸å‘é€ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥å®ç°å®æ—¶äº¤äº’RPCæ¡†æ¶åŸç†ã€‚å®šä¹‰æ ¼å¼ä¸ºrpc SayHello (stream HelloRequest) returns (stream HelloReply) {}ã€‚</p>
</li>
</ul><p>æœ¬ç¤ºä¾‹ä½¿ç”¨äº†ç®€å•æ¨¡å¼ã€‚.protoæ–‡ä»¶ä¹ŸåŒ…å«äº†Protocol Buffers æ¶ˆæ¯çš„å®šä¹‰ï¼ŒåŒ…æ‹¬è¯·æ±‚æ¶ˆæ¯å’Œè¿”å›æ¶ˆæ¯ã€‚ä¾‹å¦‚è¯·æ±‚æ¶ˆæ¯ï¼š</p><pre><code>// The request message containing the user's name.
message HelloRequest {
  string name = 1;
}
</code></pre><ol start="2">
<li>ç”Ÿæˆå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä»£ç ã€‚</li>
</ol><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®.protoæœåŠ¡å®šä¹‰ç”ŸæˆgRPCå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æ¥å£ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨protocç¼–è¯‘å·¥å…·ï¼Œå¹¶æŒ‡å®šä½¿ç”¨å…¶Goè¯­è¨€æ’ä»¶æ¥ç”Ÿæˆï¼š</p><pre><code>$ protoc -I. --go_out=plugins=grpc:$GOPATH/src helloworld.proto
$ ls
helloworld.pb.go  helloworld.proto
</code></pre><p>ä½ å¯ä»¥çœ‹åˆ°ï¼Œæ–°å¢äº†ä¸€ä¸ªhelloworld.pb.goæ–‡ä»¶ã€‚</p><ol start="3">
<li>å®ç°gRPCæœåŠ¡ã€‚</li>
</ol><p>æ¥ç€ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®ç°gRPCæœåŠ¡äº†ã€‚è¿›å…¥serverç›®å½•ï¼Œæ–°å»ºmain.goæ–‡ä»¶ï¼š</p><pre><code>$ cd ../server
$ vi main.go
</code></pre><p>main.goå†…å®¹å¦‚ä¸‹ï¼š</p><pre><code>// Package main implements a server for Greeter service.
package main

import (
	&quot;context&quot;
	&quot;log&quot;
	&quot;net&quot;

	pb &quot;github.com/marmotedu/gopractise-demo/apistyle/greeter/helloworld&quot;
	&quot;google.golang.org/grpc&quot;
)

const (
	port = &quot;:50051&quot;
)

// server is used to implement helloworld.GreeterServer.
type server struct {
	pb.UnimplementedGreeterServer
}

// SayHello implements helloworld.GreeterServer
func (s *server) SayHello(ctx context.Context, in *pb.HelloRequest) (*pb.HelloReply, error) {
	log.Printf(&quot;Received: %v&quot;, in.GetName())
	return &amp;pb.HelloReply{Message: &quot;Hello &quot; + in.GetName()}, nil
}

func main() {
	lis, err := net.Listen(&quot;tcp&quot;, port)
	if err != nil {
		log.Fatalf(&quot;failed to listen: %v&quot;, err)
	}
	s := grpc.NewServer()
	pb.RegisterGreeterServer(s, &amp;server{})
	if err := s.Serve(lis); err != nil {
		log.Fatalf(&quot;failed to serve: %v&quot;, err)
	}
}
</code></pre><p>ä¸Šé¢çš„ä»£ç å®ç°äº†æˆ‘ä»¬ä¸Šä¸€æ­¥æ ¹æ®æœåŠ¡å®šä¹‰ç”Ÿæˆçš„Goæ¥å£ã€‚</p><p>æˆ‘ä»¬å…ˆå®šä¹‰äº†ä¸€ä¸ªGoç»“æ„ä½“serverï¼Œå¹¶ä¸ºserverç»“æ„ä½“æ·»åŠ <code>SayHello(context.Context, pb.HelloRequest) (pb.HelloReply, error)</code>æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´serveræ˜¯GreeterServeræ¥å£ï¼ˆä½äºhelloworld.pb.goæ–‡ä»¶ä¸­ï¼‰çš„ä¸€ä¸ªå®ç°ã€‚</p><p>åœ¨æˆ‘ä»¬å®ç°äº†gRPCæœåŠ¡æ‰€å®šä¹‰çš„æ–¹æ³•ä¹‹åï¼Œå°±å¯ä»¥é€šè¿‡ <code>net.Listen(...)</code> æŒ‡å®šç›‘å¬å®¢æˆ·ç«¯è¯·æ±‚çš„ç«¯å£ï¼›æ¥ç€ï¼Œé€šè¿‡ <code>grpc.NewServer()</code> åˆ›å»ºä¸€ä¸ªgRPC Serverå®ä¾‹ï¼Œå¹¶é€šè¿‡ <code>pb.RegisterGreeterServer(s, &amp;server{})</code> å°†è¯¥æœåŠ¡æ³¨å†Œåˆ°gRPCæ¡†æ¶ä¸­ï¼›æœ€åï¼Œé€šè¿‡ <code>s.Serve(lis)</code> å¯åŠ¨gRPCæœåŠ¡ã€‚</p><p>åˆ›å»ºå®Œmain.goæ–‡ä»¶åï¼Œåœ¨å½“å‰ç›®å½•ä¸‹æ‰§è¡Œ <code>go run main.go</code> ï¼Œå¯åŠ¨gRPCæœåŠ¡ã€‚</p><ol start="4">
<li>å®ç°gRPCå®¢æˆ·ç«¯ã€‚</li>
</ol><p>æ‰“å¼€ä¸€ä¸ªæ–°çš„Linuxç»ˆç«¯ï¼Œè¿›å…¥clientç›®å½•ï¼Œæ–°å»ºmain.goæ–‡ä»¶ï¼š</p><pre><code>$ cd ../client
$ vi main.go
</code></pre><p>main.goå†…å®¹å¦‚ä¸‹ï¼š</p><pre><code>// Package main implements a client for Greeter service.
package main

import (
	&quot;context&quot;
	&quot;log&quot;
	&quot;os&quot;
	&quot;time&quot;

	pb &quot;github.com/marmotedu/gopractise-demo/apistyle/greeter/helloworld&quot;
	&quot;google.golang.org/grpc&quot;
)

const (
	address     = &quot;localhost:50051&quot;
	defaultName = &quot;world&quot;
)

func main() {
	// Set up a connection to the server.
	conn, err := grpc.Dial(address, grpc.WithInsecure(), grpc.WithBlock())
	if err != nil {
		log.Fatalf(&quot;did not connect: %v&quot;, err)
	}
	defer conn.Close()
	c := pb.NewGreeterClient(conn)

	// Contact the server and print out its response.
	name := defaultName
	if len(os.Args) &gt; 1 {
		name = os.Args[1]
	}
	ctx, cancel := context.WithTimeout(context.Background(), time.Second)
	defer cancel()
	r, err := c.SayHello(ctx, &amp;pb.HelloRequest{Name: name})
	if err != nil {
		log.Fatalf(&quot;could not greet: %v&quot;, err)
	}
	log.Printf(&quot;Greeting: %s&quot;, r.Message)
}
</code></pre><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡å¦‚ä¸‹ä»£ç åˆ›å»ºäº†ä¸€ä¸ªgRPCè¿æ¥ï¼Œç”¨æ¥è·ŸæœåŠ¡ç«¯è¿›è¡Œé€šä¿¡ï¼š</p><pre><code>// Set up a connection to the server.
conn, err := grpc.Dial(address, grpc.WithInsecure(), grpc.WithBlock())
if err != nil {
    log.Fatalf(&quot;did not connect: %v&quot;, err)
}
defer conn.Close()
</code></pre><p>åœ¨åˆ›å»ºè¿æ¥æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šä¸åŒçš„é€‰é¡¹ï¼Œç”¨æ¥æ§åˆ¶åˆ›å»ºè¿æ¥çš„æ–¹å¼ï¼Œä¾‹å¦‚grpc.WithInsecure()ã€grpc.WithBlock()ç­‰ã€‚gRPCæ”¯æŒå¾ˆå¤šé€‰é¡¹ï¼Œæ›´å¤šçš„é€‰é¡¹å¯ä»¥å‚è€ƒgrpcä»“åº“ä¸‹<a href="https://github.com/grpc/grpc-go/blob/v1.37.0/dialoptions.go">dialoptions.go</a>æ–‡ä»¶ä¸­ä»¥Withå¼€å¤´çš„å‡½æ•°ã€‚</p><p>è¿æ¥å»ºç«‹èµ·æ¥ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯stubï¼Œç”¨æ¥æ‰§è¡ŒRPCè¯·æ±‚<code>c := pb.NewGreeterClient(conn)</code>ã€‚åˆ›å»ºå®Œæˆä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥åƒè°ƒç”¨æœ¬åœ°å‡½æ•°ä¸€æ ·ï¼Œè°ƒç”¨è¿œç¨‹çš„æ–¹æ³•äº†ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢ä¸€æ®µä»£ç é€šè¿‡ <code>c.SayHello</code> è¿™ç§æœ¬åœ°å¼è°ƒç”¨æ–¹å¼è°ƒç”¨äº†è¿œç«¯çš„SayHelloæ¥å£ï¼š</p><pre><code>r, err := c.SayHello(ctx, &amp;pb.HelloRequest{Name: name})
if err != nil {
    log.Fatalf(&quot;could not greet: %v&quot;, err)
}
log.Printf(&quot;Greeting: %s&quot;, r.Message)
</code></pre><p>ä»ä¸Šé¢çš„è°ƒç”¨æ ¼å¼ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°RPCè°ƒç”¨å…·æœ‰ä¸‹é¢ä¸¤ä¸ªç‰¹ç‚¹ã€‚</p><ul>
<li>è°ƒç”¨æ–¹ä¾¿ï¼šRPCå±è”½äº†åº•å±‚çš„ç½‘ç»œé€šä¿¡ç»†èŠ‚ï¼Œä½¿å¾—è°ƒç”¨RPCå°±åƒè°ƒç”¨æœ¬åœ°æ–¹æ³•ä¸€æ ·æ–¹ä¾¿ï¼Œè°ƒç”¨æ–¹å¼è·Ÿå¤§å®¶æ‰€ç†ŸçŸ¥çš„è°ƒç”¨ç±»çš„æ–¹æ³•ä¸€è‡´ï¼š<code>ClassName.ClassFuc(params)</code>ã€‚</li>
<li>ä¸éœ€è¦æ‰“åŒ…å’Œè§£åŒ…ï¼šRPCè°ƒç”¨çš„å…¥å‚å’Œè¿”å›çš„ç»“æœéƒ½æ˜¯Goçš„ç»“æ„ä½“ï¼Œä¸éœ€è¦å¯¹ä¼ å…¥å‚æ•°è¿›è¡Œæ‰“åŒ…æ“ä½œï¼Œä¹Ÿä¸éœ€è¦å¯¹è¿”å›å‚æ•°è¿›è¡Œè§£åŒ…æ“ä½œï¼Œç®€åŒ–äº†è°ƒç”¨æ­¥éª¤ã€‚</li>
</ul><p>æœ€åï¼Œåˆ›å»ºå®Œmain.goæ–‡ä»¶åï¼Œåœ¨å½“å‰ç›®å½•ä¸‹ï¼Œæ‰§è¡Œgo run main.goå‘èµ·RPCè°ƒç”¨ï¼š</p><pre><code>$ go run main.go
2020/10/17 07:55:00 Greeting: Hello world
</code></pre><p>è‡³æ­¤ï¼Œæˆ‘ä»¬ç”¨å››ä¸ªæ­¥éª¤ï¼Œåˆ›å»ºå¹¶è°ƒç”¨äº†ä¸€ä¸ªgRPCæœåŠ¡ã€‚æ¥ä¸‹æ¥æˆ‘å†ç»™å¤§å®¶è®²è§£ä¸€ä¸ªåœ¨å…·ä½“åœºæ™¯ä¸­çš„æ³¨æ„äº‹é¡¹ã€‚</p><p>åœ¨åšæœåŠ¡å¼€å‘æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°ä¸€ç§åœºæ™¯ï¼šå®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œæ¥å£ä¼šé€šè¿‡åˆ¤æ–­æ˜¯å¦ä¼ å…¥æŸä¸ªå‚æ•°ï¼Œå†³å®šæ¥å£è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬æƒ³æä¾›ä¸€ä¸ªGetUseræ¥å£ï¼ŒæœŸæœ›GetUseræ¥å£åœ¨ä¼ å…¥usernameå‚æ•°æ—¶ï¼Œæ ¹æ®usernameæŸ¥è¯¢ç”¨æˆ·çš„ä¿¡æ¯ï¼Œå¦‚æœæ²¡æœ‰ä¼ å…¥usernameï¼Œåˆ™é»˜è®¤æ ¹æ®userIdæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ã€‚</p><p>è¿™æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦åˆ¤æ–­å®¢æˆ·ç«¯æœ‰æ²¡æœ‰ä¼ å…¥usernameå‚æ•°ã€‚æˆ‘ä»¬ä¸èƒ½æ ¹æ®usernameæ˜¯å¦ä¸ºç©ºå€¼æ¥åˆ¤æ–­ï¼Œå› ä¸ºæˆ‘ä»¬ä¸èƒ½åŒºåˆ†å®¢æˆ·ç«¯ä¼ çš„æ˜¯ç©ºå€¼ï¼Œè¿˜æ˜¯æ²¡æœ‰ä¼ usernameå‚æ•°ã€‚è¿™æ˜¯ç”±Goè¯­è¨€çš„è¯­æ³•ç‰¹æ€§å†³å®šçš„ï¼šå¦‚æœå®¢æˆ·ç«¯æ²¡æœ‰ä¼ å…¥usernameå‚æ•°ï¼ŒGoä¼šé»˜è®¤èµ‹å€¼ä¸ºæ‰€åœ¨ç±»å‹çš„é›¶å€¼ï¼Œè€Œå­—ç¬¦ä¸²ç±»å‹çš„é›¶å€¼å°±æ˜¯ç©ºå­—ç¬¦ä¸²ã€‚</p><p>é‚£æˆ‘ä»¬æ€ä¹ˆåˆ¤æ–­å®¢æˆ·ç«¯æœ‰æ²¡æœ‰ä¼ å…¥usernameå‚æ•°å‘¢ï¼Ÿæœ€å¥½çš„æ–¹æ³•æ˜¯é€šè¿‡æŒ‡é’ˆæ¥åˆ¤æ–­ï¼Œå¦‚æœæ˜¯nilæŒ‡é’ˆå°±è¯´æ˜æ²¡æœ‰ä¼ å…¥ï¼ŒénilæŒ‡é’ˆå°±è¯´æ˜ä¼ å…¥ï¼Œå…·ä½“å®ç°æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol>
<li>ç¼–å†™protobufå®šä¹‰æ–‡ä»¶ã€‚</li>
</ol><p>æ–°å»ºuser.protoæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹:</p><pre><code>syntax = &quot;proto3&quot;;

package proto;
option go_package = &quot;github.com/marmotedu/gopractise-demo/protobuf/user&quot;;

//go:generate protoc -I. --experimental_allow_proto3_optional --go_out=plugins=grpc:.

service User {
  rpc GetUser(GetUserRequest) returns (GetUserResponse) {}
}

message GetUserRequest {
  string class = 1;
  optional string username = 2;
  optional string user_id = 3;
}

message GetUserResponse {
  string class = 1;
  string user_id = 2;
  string username = 3;
  string address = 4;
  string sex = 5;
  string phone = 6;
}
</code></pre><p>ä½ éœ€è¦æ³¨æ„ï¼Œè¿™é‡Œæˆ‘ä»¬åœ¨éœ€è¦è®¾ç½®ä¸ºå¯é€‰å­—æ®µçš„å‰é¢æ·»åŠ äº†<strong>optional</strong>æ ‡è¯†ã€‚</p><ol start="2">
<li>ä½¿ç”¨protocå·¥å…·ç¼–è¯‘protobufæ–‡ä»¶ã€‚</li>
</ol><p>åœ¨æ‰§è¡Œprotocå‘½ä»¤æ—¶ï¼Œéœ€è¦ä¼ å…¥<code>--experimental_allow_proto3_optional</code>å‚æ•°ä»¥æ‰“å¼€<strong>optional</strong>é€‰é¡¹ï¼Œç¼–è¯‘å‘½ä»¤å¦‚ä¸‹ï¼š</p><pre><code>$ protoc --experimental_allow_proto3_optional --go_out=plugins=grpc:. user.proto
</code></pre><p>ä¸Šè¿°ç¼–è¯‘å‘½ä»¤ä¼šç”Ÿæˆuser.pb.goæ–‡ä»¶ï¼Œå…¶ä¸­çš„GetUserRequestç»“æ„ä½“å®šä¹‰å¦‚ä¸‹ï¼š</p><pre><code>type GetUserRequest struct {
    state         protoimpl.MessageState
    sizeCache     protoimpl.SizeCache
    unknownFields protoimpl.UnknownFields

    Class    string  `protobuf:&quot;bytes,1,opt,name=class,proto3&quot; json:&quot;class,omitempty&quot;`
    Username *string `protobuf:&quot;bytes,2,opt,name=username,proto3,oneof&quot; json:&quot;username,omitempty&quot;`
    UserId   *string `protobuf:&quot;bytes,3,opt,name=user_id,json=userId,proto3,oneof&quot; json:&quot;user_id,omitempty&quot;`
}
</code></pre><p>é€šè¿‡ <code>optional</code> + <code>--experimental_allow_proto3_optional</code> ç»„åˆï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸€ä¸ªå­—æ®µç¼–è¯‘ä¸ºæŒ‡é’ˆç±»å‹ã€‚</p><ol start="3">
<li>ç¼–å†™gRPCæ¥å£å®ç°ã€‚</li>
</ol><p>æ–°å»ºä¸€ä¸ªuser.goæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><pre><code>package user

import (
    &quot;context&quot;

    pb &quot;github.com/marmotedu/api/proto/apiserver/v1&quot;

    &quot;github.com/marmotedu/iam/internal/apiserver/store&quot;
)

type User struct {
}

func (c *User) GetUser(ctx context.Context, r *pb.GetUserRequest) (*pb.GetUserResponse, error) {
    if r.Username != nil {
        return store.Client().Users().GetUserByName(r.Class, r.Username)
    }

    return store.Client().Users().GetUserByID(r.Class, r.UserId)
}
</code></pre><p>æ€»ä¹‹ï¼Œåœ¨GetUseræ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ¤æ–­r.Usernameæ˜¯å¦ä¸ºnilï¼Œæ¥åˆ¤æ–­å®¢æˆ·ç«¯æ˜¯å¦ä¼ å…¥äº†Usernameå‚æ•°ã€‚</p><h2>RESTful VS gRPC</h2><p>åˆ°è¿™é‡Œï¼Œä»Šå¤©æˆ‘ä»¬å·²ç»ä»‹ç»å®Œäº†gRPC APIã€‚å›æƒ³ä¸€ä¸‹æˆ‘ä»¬æ˜¨å¤©å­¦ä¹ çš„RESTful APIï¼Œä½ å¯èƒ½æƒ³é—®ï¼šè¿™ä¸¤ç§APIé£æ ¼åˆ†åˆ«æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Œé€‚ç”¨äºä»€ä¹ˆåœºæ™¯å‘¢ï¼Ÿæˆ‘æŠŠè¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆæ”¾åœ¨äº†ä¸‹é¢è¿™å¼ è¡¨ä¸­ï¼Œä½ å¯ä»¥å¯¹ç…§ç€å®ƒï¼Œæ ¹æ®è‡ªå·±çš„éœ€æ±‚åœ¨å®é™…åº”ç”¨æ—¶è¿›è¡Œé€‰æ‹©ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/e6/ab/e6ae61fc4b0fc821f94d257239f332ab.png?wh=1483x1026" alt=""></p><p>å½“ç„¶ï¼Œæ›´å¤šçš„æ—¶å€™ï¼ŒRESTful API å’ŒgRPC APIæ˜¯ä¸€ç§åˆä½œçš„å…³ç³»ï¼Œå¯¹å†…ä¸šåŠ¡ä½¿ç”¨gRPC APIï¼Œå¯¹å¤–ä¸šåŠ¡ä½¿ç”¨RESTful APIï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://static001.geekbang.org/resource/image/47/18/471ac923d2eaeca8fe13cb74731c1318.png?wh=1606x1144" alt=""></p><h2>æ€»ç»“</h2><p>åœ¨Goé¡¹ç›®å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ä½¿ç”¨ RESTful API é£æ ¼å’Œ RPC API é£æ ¼ï¼Œè¿™ä¸¤ç§æœåŠ¡éƒ½ç”¨å¾—å¾ˆå¤šã€‚å…¶ä¸­ï¼ŒRESTful APIé£æ ¼å› ä¸ºè§„èŒƒã€æ˜“ç†è§£ã€æ˜“ç”¨ï¼Œæ‰€ä»¥<strong>é€‚åˆç”¨åœ¨éœ€è¦å¯¹å¤–æä¾›APIæ¥å£çš„åœºæ™¯ä¸­</strong>ã€‚è€ŒRPC APIå› ä¸ºæ€§èƒ½æ¯”è¾ƒé«˜ã€è°ƒç”¨æ–¹ä¾¿ï¼Œ<strong>æ›´é€‚åˆç”¨åœ¨å†…éƒ¨ä¸šåŠ¡ä¸­</strong>ã€‚</p><p>RESTful APIä½¿ç”¨çš„æ˜¯HTTPåè®®ï¼Œè€ŒRPC APIä½¿ç”¨çš„æ˜¯RPCåè®®ã€‚ç›®å‰ï¼Œæœ‰å¾ˆå¤šRPCåè®®å¯ä¾›ä½ é€‰æ‹©ï¼Œè€Œæˆ‘æ¨èä½ ä½¿ç”¨gRPCï¼Œå› ä¸ºå®ƒå¾ˆè½»é‡ï¼ŒåŒæ—¶æ€§èƒ½å¾ˆé«˜ã€å¾ˆç¨³å®šï¼Œæ˜¯ä¸€ä¸ªä¼˜ç§€çš„RPCæ¡†æ¶ã€‚æ‰€ä»¥ç›®å‰ä¸šç•Œç”¨çš„æœ€å¤šçš„è¿˜æ˜¯gRPCåè®®ï¼Œè…¾è®¯ã€é˜¿é‡Œç­‰å¤§å‚å†…éƒ¨å¾ˆå¤šæ ¸å¿ƒçš„çº¿ä¸ŠæœåŠ¡ç”¨çš„å°±æ˜¯gRPCã€‚</p><p>é™¤äº†ä½¿ç”¨gRPCåè®®ï¼Œåœ¨è¿›è¡ŒGoé¡¹ç›®å¼€å‘å‰ï¼Œä½ ä¹Ÿå¯ä»¥äº†è§£ä¸šç•Œä¸€äº›å…¶ä»–çš„ä¼˜ç§€Go RPCæ¡†æ¶ï¼Œæ¯”å¦‚è…¾è®¯çš„tars-goã€é˜¿é‡Œçš„dubbo-goã€Facebookçš„thriftã€rpcxç­‰ï¼Œä½ å¯ä»¥åœ¨é¡¹ç›®å¼€å‘ä¹‹å‰ä¸€å¹¶è°ƒç ”ï¼Œæ ¹æ®å®é™…æƒ…å†µè¿›è¡Œé€‰æ‹©ã€‚</p><h2>è¯¾åç»ƒä¹ </h2><ol>
<li>ä½¿ç”¨gRPCåŒ…ï¼Œå¿«é€Ÿå®ç°ä¸€ä¸ªRPC APIæœåŠ¡ï¼Œå¹¶å®ç°PrintHelloæ¥å£ï¼Œè¯¥æ¥å£ä¼šè¿”å›â€œHello Worldâ€å­—ç¬¦ä¸²ã€‚</li>
<li>è¯·ä½ æ€è€ƒè¿™ä¸ªåœºæ™¯ï¼šä½ æœ‰ä¸€ä¸ªgRPCæœåŠ¡ï¼Œä½†æ˜¯å´å¸Œæœ›è¯¥æœåŠ¡åŒæ—¶ä¹Ÿèƒ½æä¾›RESTful APIæ¥å£ï¼Œè¿™è¯¥å¦‚ä½•å®ç°ï¼Ÿ</li>
</ol><p>æœŸå¾…åœ¨ç•™è¨€åŒºçœ‹åˆ°ä½ çš„æ€è€ƒå’Œç­”æ¡ˆï¼Œä¹Ÿæ¬¢è¿å’Œæˆ‘ä¸€èµ·æ¢è®¨å…³äºRPC APIç›¸å…³çš„é—®é¢˜ï¼Œæˆ‘ä»¬ä¸‹ä¸€è®²è§ï¼</p><h2>ç²¾é€‰ç•™è¨€ï¼š</h2>
        <ul>
        
<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            pedro  2021-06-24 07:42:16
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            å‡å®šå¸Œæœ›ç”¨RPCä½œä¸ºå†…éƒ¨APIçš„é€šè®¯ï¼ŒåŒæ—¶ä¹Ÿæƒ³å¯¹å¤–æä¾›RESTful APIï¼Œåˆä¸æƒ³å†™ä¸¤å¥—ï¼Œå¯ä»¥ä½¿ç”¨gRPC Gateway æ’ä»¶ï¼Œåœ¨ç”ŸæˆRPCçš„åŒæ—¶ä¹Ÿç”ŸæˆRESTful web  serverã€‚ [3èµ]
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            æŸ æŸ   2021-06-25 15:55:40
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            RPC ä¸ RESTful å…±é€šé€»è¾‘æŠ½è±¡å‡ºæ¥ Service å±‚ï¼ŒRPC server å’Œ RESTful server åˆå§‹åŒ–or å¯åŠ¨æ—¶æ—¶éƒ½éœ€è¦æŒ‡å®š serviceï¼ŒçœŸæ­£æä¾›æœåŠ¡çš„æ˜¯ Service å±‚ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            ğŸ’A  2021-06-25 08:38:57
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            https:&#47;&#47;www.bookstack.cn&#47;read&#47;API-design-guide&#47;API-design-guide-04-%E6%A0%87%E5%87%86%E6%96%B9%E6%B3%95.md  æˆ‘åˆæ¥åšè´¡çŒ®äº† 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            learner2021  2021-06-24 23:54:12
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            å“ªé‡Œè®¾ç½®é”™è¯¯äº†ï¼Ÿ<br>[going@dev server]$ pwd<br>&#47;home&#47;going&#47;workspace&#47;golang&#47;src&#47;github.com&#47;marmotedu&#47;gopractise-demo&#47;apistyle&#47;greeter&#47;server<br>[going@dev server]$ go run main.go<br>main.go:8:2: no required module provides package github.com&#47;marmotedu&#47;gopractise-demo&#47;apistyle&#47;greeter&#47;helloworld: go.mod file not found in current directory or any parent directory; see &#39;go help modules&#39;<br>main.go:9:2: no required module provides package google.golang.org&#47;grpc: go.mod file not found in current directory or any parent directory; see &#39;go help modules&#39; 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            kkgo  2021-06-24 23:19:00
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            è€å¸ˆæœ‰å¯¹æ¯”è¿‡grpcå’Œrpcxä¹‹é—´çš„æ€§èƒ½ï¼Œç¨³å®šæ€§æ–¹é¢ä¸? çœ‹å®˜æ–¹è¯´æ˜rpcxæ€§èƒ½æ˜¯grpcçš„2å€ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            helloworld  2021-06-24 22:07:27
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            ä¼˜ç§€ğŸ‘ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            StarÂ°æ—¶å…‰â„¡  2021-06-24 22:03:13
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            protoc -I. --go_out=plugins=grpc:$GOPATH&#47;src helloworld.proto<br>æ‰§è¡Œå‘½ä»¤åæ— ä»»ä½•è¾“å‡ºï¼Œä¹Ÿæ²¡æœ‰äº§ç”Ÿhelloworld.pb.goæ–‡ä»¶ 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            StarÂ°æ—¶å…‰â„¡  2021-06-24 22:02:07
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            protoc -I. --go_out=plugins=grpc:$GOPATH&#47;src helloworld.proto<br>```<br>[root@dev helloword]# ls<br>helloworld.proto<br>[root@dev helloword]# cat helloworld.proto <br>syntax = &quot;proto3&quot;;<br><br>option go_package = &quot;github.com&#47;marmotedu&#47;gopractise-demo&#47;apistyle&#47;greeter&#47;helloworld&quot;;<br><br>package helloworld;<br><br>&#47;&#47; the greeting service definition<br>service Greeter {<br>    &#47;&#47; sends a greeting<br>    rpc SayHello (HelloRequest) returns (HelloReply) {}<br>}<br><br>&#47;&#47; the request message containing the user&#39;s name.<br>message HelloRequest {<br>    string name = 1;<br>}<br><br>&#47;&#47; the response message containing the greetings<br>message HelloReply {<br>    string message = 1;<br>}[root@dev helloword]# protoc -I. --go_out=plugins=grpc:$GOPATH&#47;src helloworld.proto<br>[root@dev helloword]# ls<br>helloworld.proto<br>``` 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            å¤å¤œæ˜Ÿè¯­  2021-06-24 16:28:48
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            ä¹‹å‰è‡ªå·±è¿˜ç”¨jsonrpc å†™rpc, ç°åœ¨ç”¨è¿™ä¸ªæ„Ÿè§‰å®Œå…¨æ¥å£æ›´è§„èŒƒï¼Œæ›´ç®€å• 
        </div>
        
    </div>
</li>
            
<br/>

<li>
    <div>
        <div style="color: #888;font-size:15.25px;font-weight:400;            line-height:1.2">
            ä¸æ˜çœŸç›¸çš„ç¾¤ä¼—  2021-06-24 14:24:46
        </div>
        <div style="color:#353535;font-weight:400;white-space:normal;            word-break:break-all;line-height:1.6">
            ä½ æœ‰ä¸€ä¸ª gRPC æœåŠ¡ï¼Œä½†æ˜¯å´å¸Œæœ›è¯¥æœåŠ¡åŒæ—¶ä¹Ÿèƒ½æä¾› RESTful API æ¥å£ï¼Œè¿™è¯¥å¦‚ä½•å®ç°ï¼Ÿ<br>---------------------------<br>åœ¨å°è£…ä¸€å±‚ï¼Ÿ 
        </div>
        
    </div>
</li>
            </ul>
</div>
</body>
</html>